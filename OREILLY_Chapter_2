-- SELECT로 행 검색하기

SELECT
    gender, tripduration
FROM 
    `bigquery-public-data`.new_york_citibike.citibike_trips
LIMIT 5


-- AS 별칠 붙이기

SELECT
    gender, tripduration AS rental_duration
FROM 
    `bigquery-public-data`.new_york_citibike.citibike_trips
LIMIT 5

#컬럼 별칭은 데이터를 변환할때 유용하다 아래의 쿼리를 봐보자

-- 데이터 변환시 별칭 사용하기 

SELECT
    gender, tripduration/60 AS rental_duration
FROM 
    `bigquery-public-data`.new_york_citibike.citibike_trips
LIMIT 5

# SELECT 절에서 바로 데이터 변환이 되어지는데 이때 별칭을 사용하지 않으면 컬럼명이 자동으로 생성되어진다.
# 그러니 가독성을 위해 꼭! AS를 사용해주자

-- WHERE로 필터링하기(pg 59)
# 대여한 사람이 여성이고 대여 기간이 5분에서 10분 사이인 대여 건
SELECT
    gender, tripduration
FROM 
    `bigquery-public-data`.new_york_citibike.citibike_trips
WHERE tripduration >= 300 AND tripduration < 600 AND gender = 'female'
LIMIT 5

# 집계 pg 63
# WHERE 절로 집계시 남녀 중 하나만 집계가 가능하다. 즉, 남녀를 구하기 위해선 쿼리를 두번 날려야 하기 때문에 비용이 두배로 든다. 
# 이럴때는 GROUP BY 절로 집계를 하여 쿼리르 날리면 한번에 구하 수 있다. 
# GROUP BY로 집계하기, 남녀 사용자의 평균 대여 시간을 찾는다

SELECT
    gender, AVG(tripduration/60) AS avg_trip_duration
FROM 
    `bigquery-public-data`.new_york_citibike.citibike_trips
WHERE
    tripduration is not NULL
GROUP BY 
    gender
ORDER BY 
    avg_trip_duration


#




